<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/defaultLayout}"
      layout:fragment="Content">
<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    
    <!-- Google Tag Manager -->
    <!-- End Google Tag Manager -->
    <!-- External CSS libraries -->
    <!-- Favicon icon -->
    <!-- Google fonts -->
    <!-- Custom Stylesheet -->
	
    <!-- profile.html 필요 css -->
   <!--  <link rel="stylesheet" type="text/css" href="css/profile.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
 -->
<style>
p { margin:100px 0px; }
</style>
	<style>
		table {
			font-family: arial, sans-serif;
			border-collapse: collapse;
			width: 100%;
		}

		td, th {
			border: 1px solid #dddddd;
			text-align: left;
			padding: 8px;
		}

		tr:nth-child(even) {
			background-color: #dddddd;
		}
	</style>
    
</head>
<body id="top">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PDTWJ3Z"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div class="page_loader"></div>

<!-- main header start -->
	<!-- common/header.html -->
<!-- main header end -->

<!-- Sub banner start -->
<div class="sub-banner">
    <div class="container">
        <div class="breadcrumb-area">
            <h1>마이 트립</h1>
        </div>
    </div>
</div>
<!-- Sub banner end -->

<!-- Destination start -->
<div class="destination d-2 content-area-2">
    <div class="container">
	    
	    <div style="font-size:50px">환영합니다! 관리자님</div><br>
	    <br><hr><br>

        <!-- small navbar start -->
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#first">예약 현황</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#second">서울매출</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#third">제주매출</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#forth">부산매출</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#fifth">대전매출</a>
            </li>
             <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#sixth">지역별매출</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#seventh">선호도TOP5</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#eighth">리뷰 목록</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/insert">호텔 등록</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade show active" id="first">
                <p>
                <table>
                    <tr>
                        <th>예약자이름</th>
                        <th>예약자ID</th>
                        <th>예약 번호</th>
                        <th>결제일</th>
                    </tr>
                    <tr th:each="admin:${admin}">
                        <td th:text="${admin[1].name}"></td>
                        <td th:text="${admin[1].username}"></td>
                        <td th:text="${admin[0].resIndex}"></td>
                        <td th:text="${admin[0].payDate}"></td>
                    </tr>
                </table>
                </p>
            </div>

<!--            <div class="tab-pane fade" id="first">-->
<!--                <p><th:text="${hotel.hotelName}"></td></p>-->
<!--            </div>-->

            <div class="tab-pane fade" id="second">
                <div>
                    <p>
                <div id="chart_div"></div>
                    </p>
                </div>
                </div>
            <div class="tab-pane fade" id="third">
                <div>
                    <p>
                    <div id="chart_div2"></div>
                    </p>
                </div>
            </div>
            <div class="tab-pane fade" id="forth">
                <div>
                    <p>
                    <div id="chart_div3"></div>
                    </p>
                </div>
            </div>
            <div class="tab-pane fade" id="fifth">
                <div>
                    <p>
                    <div id="chart_div4"></div>
                    </p>
                </div>
            </div>
            <div class="tab-pane fade" id="sixth">
                <div>
                    <p>
                    <div id="chart_div5"></div>              
                    </p>
                </div>
            </div>
            <div class="tab-pane fade" id="seventh">
                
					
                  <div id="chart_div6"></div>              
					
               
            </div>
            
            <div class="tab-pane fade" id="eighth">
              <p>
					<table>
					  <thead>
					    <tr>
					      <th>리뷰내용</th>
					      <th>적용날짜</th>
					      <th>별점</th>
					      <th>예약번호</th>
					      <th>Action</th>
					    </tr>
					  </thead>
					  <tbody>
					    <tr th:each="review : ${reviews}">
					      <td th:text="${review.context}">리뷰내용</td>
					      <td th:text="${review.date}">날짜</td>
					      <td th:text="${review.score}">스코어</td>
					      <td th:text="${review.reservation.resIndex}">예약 인덱스</td>
					      <td>
					        <form th:action="@{/reviews/{id}(id=${review.revIndex})}" method="post">
							    <input type="hidden" name="_method" value="delete" />
							    <button type="submit">삭제</button>
							</form>
					      </td>
					    </tr>
					  </tbody>
					</table>
                </p> 
            </div>
            
        </div>
        <!-- small navbar end -->

</div>
</div>

<!-- Destination end -->
<script id="chart" th:attr="data-hoteldata=${hoteldata}" th:inline="javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {

        var arr = [
            ['hoteName', 'profit']
        ];
        var arr2 = [
            ['hoteName', 'profit']
        ];
        var arr3 = [
            ['hoteName', 'profit']
        ];
        var arr4 = [
            ['hoteName', 'profit']
        ];
        var hoteldata = JSON.parse(document.getElementById("chart").getAttribute("data-hoteldata"));
        for (var i=0;i<10;i++){
            var hotelId = hoteldata[i][0];
            var profit = hoteldata[i][1];
            arr.push([hotelId,profit]);
        }
        for (var i=10;i<20;i++){
            var hotelId = hoteldata[i][0];
            var profit = hoteldata[i][1];
            arr2.push([hotelId,profit]);
        }
        for (var i=20;i<30;i++){
            var hotelId = hoteldata[i][0];
            var profit = hoteldata[i][1];
            arr3.push([hotelId,profit]);
        }
        for (var i=30;i<40;i++){
            var hotelId = hoteldata[i][0];
            var profit = hoteldata[i][1];
            arr4.push([hotelId,profit]);
        }
        var data = google.visualization.arrayToDataTable(arr);
        var data2 = google.visualization.arrayToDataTable(arr2);
        var data3 = google.visualization.arrayToDataTable(arr3);
        var data4 = google.visualization.arrayToDataTable(arr4);
        var options = {
            title: '호텔 수익',
            width: 1400,
            height: 400,
            legend: { position: 'top', maxLines: 3 },
            hAxis: { title: '호텔' },
            vAxis: { title: '수익' }
        };
        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
        var chart2 = new google.visualization.ColumnChart(document.getElementById('chart_div2'));
        chart2.draw(data2, options);
        var chart3 = new google.visualization.ColumnChart(document.getElementById('chart_div3'));
        chart3.draw(data3, options);
        var chart4 = new google.visualization.ColumnChart(document.getElementById('chart_div4'));
        chart4.draw(data4, options);
    }
</script>

 <script type="text/javascript" id="pie" th:attr="data-totprofit=${totprofit}" th:inline="javascript" >
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
        var totprofit = JSON.parse(document.getElementById("pie").getAttribute("data-totprofit"));
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Area');
        data.addColumn('number', 'Profit');
        
        for (var i = 0; i < totprofit.length; i++) {
            data.addRow([totprofit[i][0],totprofit[i][1]]);
        }

        var options = {
            width: 1200,
            height: 700
        };

        var chart = new google.visualization.PieChart(document.getElementById('chart_div5'));

        chart.draw(data, options);
    }
    
</script>


<script id="preference" th:attr="data-preference=${preference}" th:inline="javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    
    function drawChart() {

    	 var preference = JSON.parse(document.getElementById("preference").getAttribute("data-preference"));
         var data = new google.visualization.DataTable();
         data.addColumn('string', '호텔');
         data.addColumn('number', '선호도');

         for (var i = 0; i < preference.length; i++) {
             data.addRow([preference[i][0],preference[i][1]]);
         }
         
        var options = {
            title: '호텔 선호도',
            width: 1400,
            height: 400,
            legend: { position: 'top', maxLines: 3 },
            hAxis: { title: '호텔' },
            vAxis: { title: '선호도' }
        };
        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div6'));
        chart.draw(data, options);
    }
</script>

<!-- Footer-6 start -->
	<!-- common/footer.html -->
<!-- Footer-6 end -->

<!-- External JS libraries -->
<!-- Custom JS Script -->

<!-- profile.html 필요 JS 라이브러리 -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>


</html>
